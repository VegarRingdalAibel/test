"use strict";function rerenderInnerHTML(){document.body&&requestAnimationFrame(()=>{const e=document.body.innerHTML;document.body.innerHTML="",document.body.innerHTML=e})}function initCache(){globalThis.hmrCache||(globalThis.hmrCache={},globalThis.hmrCacheSymbolAttributes={},globalThis.hmrCacheSymbolObserver={})}function getMostRecentImpl(e){return globalThis.hmrCache[e]}function setMostRecentImpl(e,t){globalThis.hmrCache[e]=t}function isCacheInitialized(){return globalThis.hmrCache.initialized}function setCacheAsInitialized(){globalThis.hmrCache.initialized=!0}function getSymbolAttributes(e){return globalThis.hmrCacheSymbolAttributes[e]?globalThis.hmrCacheSymbolAttributes[e]:(globalThis.hmrCacheSymbolAttributes[e]=Symbol("observedAttributesArray"),globalThis.hmrCacheSymbolAttributes[e])}function getSymbolObserver(e){return globalThis.hmrCacheSymbolObserver[e]?globalThis.hmrCacheSymbolObserver[e]:(globalThis.hmrCacheSymbolObserver[e]=Symbol("observedAttributesObserver"),globalThis.hmrCacheSymbolObserver[e])}function createHookClass(e,t){return class extends t{static get observedAttributes(){return[]}connectedCallback(){const t=getMostRecentImpl(e),o=t.prototype,r=t[getSymbolAttributes(e)];r&&(Array.isArray(r)?r.forEach(e=>{o.attributeChangedCallback.apply(this,[e,null,this.getAttribute(e)])}):console.warn(`observedAttributes in ${e} is not array, please fix`)),this[getSymbolObserver(e)]=new MutationObserver(e=>{e.forEach(e=>{o.attributeChangedCallback&&r&&-1!==r.indexOf(e.attributeName)&&o.attributeChangedCallback.apply(this,[e.attributeName,e.oldValue,e.target.getAttribute(e.attributeName)])})}),this[getSymbolObserver(e)].observe(this,{childList:!1,attributes:!0,attributeOldValue:!0,subtree:!1}),o.connectedCallback&&o.connectedCallback.apply(this,arguments)}disconnectedCallback(){this[getSymbolObserver(e)].disconnect(),this[getSymbolObserver(e)]=null;const t=getMostRecentImpl(e).prototype;t.disconnectedCallback&&t.disconnectedCallback.apply(this,arguments)}adoptedCallback(){const t=getMostRecentImpl(e).prototype;t.adoptedCallback&&t.adoptedCallback.apply(this,arguments)}}}function patch(e,t,o){const r=Object.getOwnPropertyNames(e).filter(e=>-1===o.indexOf(e));for(let o=0;o<r.length;o++){const n=Object.getOwnPropertyDescriptor(e,r[o]);n&&(n.configurable?Object.defineProperty(t,r[o],n):console.warn("[custom-element-hmr-polyfill]",`${r[o]} is not configurable, skipping`))}}Object.defineProperty(exports,"__esModule",{value:!0});const BLACKLISTED_PROTOTYPE_PATCH_METHODS=[],BLACKLISTED_STATIC_PATCH_METHODS=["name","prototype","length"];function constructInstance(e,t,o){let r=window[e.__proto__.name];return r&&(r=window[e.__proto__.name].prototype instanceof Element),r||(patch(e.__proto__.prototype,o.prototype,BLACKLISTED_PROTOTYPE_PATCH_METHODS),patch(e.__proto__,o,BLACKLISTED_STATIC_PATCH_METHODS)),patch(e.prototype,o.prototype,BLACKLISTED_PROTOTYPE_PATCH_METHODS),patch(e,e,BLACKLISTED_STATIC_PATCH_METHODS),Reflect.construct(e,t,o)}function overrideCustomElementDefine(){if(!isCacheInitialized()){setCacheAsInitialized();const e=CustomElementRegistry.prototype.define;CustomElementRegistry.prototype.define=function(t,o,r){const n=customElements.get(t);if(o[getSymbolAttributes(t)]=o.observedAttributes,setMostRecentImpl(t,o),n){const e=globalThis.hmrCache.onCustomElementChange;e&&"function"==typeof e&&e(t,o,r)}else{const n=new Proxy(createHookClass(t,o),{construct:function(e,o,r){return constructInstance(getMostRecentImpl(t),o,r)}});e.apply(this,[t,n,r])}}}}const onCustomElementChange=e=>{initCache(),globalThis.hmrCache.onCustomElementChange||(globalThis.hmrCache.onCustomElementChange=e)};!function(e){e.RERENDER_INNER_HTML="rerenderInnnerHTML",e.NONE="none"}(exports.ReflowStrategy||(exports.ReflowStrategy={}));const createHookElementChangeListener=(e=exports.ReflowStrategy.RERENDER_INNER_HTML,t=250,o)=>{let r,n=[];return o||(o=()=>{}),(l,a,s)=>{o(l,a,s),e&&e===exports.ReflowStrategy.RERENDER_INNER_HTML&&(n.push(l),clearTimeout(r),r=setTimeout(()=>{rerenderInnerHTML(),n=[]},t))}};function applyPolyfill(e=exports.ReflowStrategy.NONE,t=250,o){initCache(),overrideCustomElementDefine(),onCustomElementChange(createHookElementChangeListener(e,t,o))}exports.applyPolyfill=applyPolyfill,exports.rerenderInnerHTML=rerenderInnerHTML;
//# sourceMappingURL=custom-elements-hmr-pollyfill.cjs.js.map
